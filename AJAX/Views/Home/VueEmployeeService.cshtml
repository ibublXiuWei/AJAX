@section Styles{
		<style>

		</style>
}

<div id="app">
	@*篩選*@
	<div class="row" style="width:40%;margin-left:auto;margin-right:5px;">
		<label class="col-lg-3">請輸入關鍵字</label>
		<input class="col-lg-7" v-model="Filter" placeholder="輸入篩選關鍵字" />
		<button class="btn btn-outline-primary" @@click="filterEmployeeDTO">篩選</button>
	</div>
	<button type="button" class="btn btn-success" @@click="showModel"> 新增員工紀錄</button>
	<div class="row">
		<div class="col-12 mt-4">
			<table class="table table-striped table-hover">
				<thead>
					<tr>
						<td>員工編號</td>
						<td>姓</td>
						<td>名</td>
						<td>職務</td>
					</tr>
				</thead>
				<tbody>
					<tr v-for="item in EmployeeDTOes">
						<template v-if="item.Edit==true">
							<td>{{item.employeeId}}</td>
							<td><input v-model="item.lastName"/></td>
							<td><input v-model="item.firstName" /></td>
							<td><input v-model="item.title" /></td>
							<td>
								<button type="button" class="btn btn-primary" @@click="update(item)">修改</button>
								<button type="button" class="btn btn-primary" @@click="cancel">取消</button>
							</td>
						</template>
						<template v-else="">
							<td>{{item.employeeId}}</td>
							<td>{{item.lastName}}</td>
							<td>{{item.firstName}}</td>
							<td>{{item.title}}</td>
							<td>
								<button type="button" class="btn btn-info" @@click="edit(item.employeeId)">編輯</button>
								<button type="button" class="btn btn-danger" @@click="deleteEmployee(item.employeeId)">刪除</button>
							</td>
						</template>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	@*新增*@


</div>

@section Scripts{

		<script src="https://unpkg.com/vue@next"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.3/axios.min.js"></script>

		<script>
			var webApiBaseAddr = "https://localhost:7175";
			var vueApp={
				data(){
					return{
						Filter:"",
						EmployeeDTOes:[],

					};
				},
				//mounted 初始化
				mounted:function(event){
					let _this=this;
					_this.getEmployeeDTOes();
				},
				methods:{
					getEmployeeDTOes:function(){
						//alert("getEmployeeDTOes");
						let _this=this;
						axios.get(`${webApiBaseAddr}/api/Employees`).then(response=>{
							_this.EmployeeDTOes=response.data;
							var employeeList=[];
							for (var i = 0; i < _this.EmployeeDTOes.length; i++) {
								var item={};
								item = _this.EmployeeDTOes[i];
								item.Edit=false;
								employeeList.push(item);
							}
							_this.EmployeeDTOes = employeeList;
						});
					},
					showModel:function(){
						alert("showModel");
					},
					update:function(item){
						alert("update");
					},
					cancel:function(){
						alert("cancel");
					},
					edit:function(employeeId){
						alert("edit");
					},
					deleteEmployee:function(employeeId){
						alert("delete");

					},
					filterEmployeeDTO:function(){
						//let _this=this;
						//alert(_this.Filter);
						let _this=this;
						var request={};
						request.FirstName=_this.Filter;
						axios.post(`${webApiBaseAddr}/api/Employees/Filter`,request).then(response=>{
							_this.EmployeeDTOes=response.data;
							var employeeList=[];
							for (var i = 0; i < _this.EmployeeDTOes.length; i++) {
								var item={};
								item = _this.EmployeeDTOes[i];
								item.Edit=false;
								employeeList.push(item);
							}
							_this.EmployeeDTOes = employeeList;
						});
					}	
				}
			};
			var app=Vue.createApp(vueApp).mount("#app");
		</script>
}